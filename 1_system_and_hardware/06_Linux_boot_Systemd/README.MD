## Домашнее задание
### Systemd

<details>
<summary> Дано </summary> 
  

1. Написать сервис, который будет раз в 30 секунд мониторить лог на предмет наличия ключевого слова. Файл и слово должны задаваться в /etc/sysconfig
2. Из epel установить spawn-fcgi и переписать init-скрипт на unit-файл. Имя сервиса должно так же называться.
3. Дополнить юнит-файл apache httpd возможностьб запустить несколько инстансов сервера с разными конфигами
4*. Скачать демо-версию Atlassian Jira и переписать основной скрипт запуска на unit-файл
</details>

______________________________________________________
### Сервис который раз в 30 секунд монитор лог на предмет наличия ключевого слова:

Написал сервис *greplog.service* который раз в 30 секунд монитор лог файл */var/log/messages* на наличие слова *eth1*.
Параметры сервиса можно задать в файле */etc/sysconfig/greplog*
______________________________________________________

### Переписал init-скрипт на unit-файл для сервиса spawn-fcgi.

Какого либо опыта для написания что init скриптов, что unit файлов не имел. Не знал с какой стороны подойдти. 
В итоге вроде как разоборался, но нужно будет как то закрепить :)
Т.к. Александр говорил, что сервис желательно всегда запускать в режиме **simple** решил добиться этого. 
Сам юнит файл привел к такому виду:

`````
[Unit]
Description=Spawn FastCGI scripts to be used by web servers
After=network.target

[Service]
Type=simple
EnvironmentFile=/etc/sysconfig/spawn-fcgi
ExecStart=/usr/bin/spawn-fcgi $OPTIONS
KillMode=process

[Install]
WantedBy=multi-user.target
`````
Так же необходимо раскоментировать параметры из EnvironmentFil'a, после чего запустив службу мы увидим что php-cgi работают. 
А вот родительский процесс умер, насколько я понял это происходит из за того что по умолчанию программа демонизируется.
Читаем ман к spawn-fcgi и находим ключ **-n**.
Привим */etc/sysconfig/spawn-fcgi* к виду: 
`````
SOCKET=/var/run/php-fcgi.sock
OPTIONS="-u apache -g apache -s $SOCKET -S -M 0600 -C 32 -n -P /var/run/spawn-fcgi.pid -- /usr/bin/php-cgi"
`````
и все работает :)
_______________________________________________
### Дополнить юнит-файл apache httpd возможностьб запустить несколько инстансов сервера с разными конфигами

Копируем и переименовываем дефолтный юнит httpd.service в директорию */etc/systemd/system/httpd@.service*.
Добавляем в **ExecStart** ключ: *-f /etc/httpd/conf/%i.conf*. 
К основному **httpd.service** я буду запускать дополнительный **httpd@test1.service**, для этого еще осталось скопировать конфиг службы,
и подправить **PidFile** и порт **ListenPort** который он будет слушать


















